<?xml version="1.0" encoding="UTF-8"?>
<component-configuration
        xmlns="http://tis.co.jp/nablarch/component-configuration"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://tis.co.jp/nablarch/component-configuration  /component-configuration.xsd">

  <config-file file="classpath:nablarch/tool/definitioninfogenerator/loader/poi/definitioninfogenerator.config"/>

  <!-- テーブル定義 -->
  <component name="tableDefinitionLoader"
             class="nablarch.tool.definitioninfogenerator.loader.poi.TableDefinitionFileLoader">
    <property name="pathToBook" value="${tableDefinitionFilePath}"/>
    <!-- データ読み取り開始行 -->
    <property name="startRowIndex" value="10"/>

    <!-- 取得用keyは、<property name="indexNamePairs">のvalue値と合わせること -->
    <!-- カラム物理名称取得用key -->
    <property name="keyName" value="physicalColumnName"/>

    <!-- テーブル論理名を記載したセル位置（0オリジン） -->
    <property name="logicalTableNameRowIndex" value="4"/>
    <property name="logicalTableNameColumnIndex" value="5"/>
    <!-- テーブル物理名を記載したセル位置（0オリジン） -->
    <property name="physicalTableNameRowIndex" value="4"/>
    <property name="physicalTableNameColumnIndex" value="22"/>
    <!-- テーブル説明を記載したセル位置（0オリジン） -->
    <property name="tableDescriptionRowIndex" value="5"/>
    <property name="tableDescriptionColumnIndex" value="5"/>

    <property name="columnDefs" ref="tableDefinitionColumnDefs"/>
    <!-- 取得対象外のシート名 -->
    <property name="excludedSheets">
      <list>
        <value>表紙</value>
        <value>変更履歴</value>
        <value>目次</value>
        <value>データ</value>
      </list>
    </property>
  </component>

  <!-- 設計書から取得する際の定義 -->
  <component name="tableDefinitionColumnDefs"
             class="nablarch.tool.util.poi.XlsColumnDefs">
    <property name="indexNamePairs">
      <map>
        <!-- key：Excelの列位置（0オリジン）、
             value：データを取得する際のkey -->
        <entry key="1" value="logicalColumnName"/>
        <entry key="6" value="physicalColumnName"/>
        <entry key="11" value="domainName"/>
        <entry key="16" value="dataType"/>
        <entry key="19" value="length"/>
        <entry key="21" value="primaryKeyOrder"/>
        <entry key="22" value="required"/>
        <entry key="30" value="columnDefinition"/>
        <entry key="40" value="initialValue"/>
        <entry key="42" value="encryptionTarget"/>
        <entry key="44" value="note"/>
      </map>
    </property>
  </component>

  <!-- 定義情報自動生成クラス -->
  <component name="definitionInfoGenerator"
             class="nablarch.tool.definitioninfogenerator.DefinitionInfoGenerator">
    <!-- 出力ファイル名 -->
    <property name="fileName" value="DB項目定義"/>
    <!-- 出力フォルダ -->
    <property name="outputDir" value="${outputDir}"/>
  </component>

</component-configuration>
